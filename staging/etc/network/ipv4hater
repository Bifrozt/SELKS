# Generated by iptables-save v1.4.21 on Sun Nov  1 20:02:15 2015
*filter
:INPUT DROP [395:41336]
:FORWARD ACCEPT [10483:9619306]
:OUTPUT ACCEPT [0:0]
:LOGALLOW - [0:0]
:LOGNDROP - [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -i eth1 -m pkttype --pkt-type broadcast -j ACCEPT
-A INPUT -i eth1 -p tcp -m tcp --sport 22 -j ACCEPT
-A INPUT -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -i eth0 -p tcp -m tcp --dport 58595 -j ACCEPT
-A FORWARD -i eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -i eth1 -m state --state INVALID -j LOGNDROP
-A FORWARD -i eth1 -p icmp -m icmp --icmp-type 8 -m recent --set --name PING --mask 255.255.255.255 --rsource -m limit --limit 2/sec --limit-burst 2 -j LOGALLOW
-A FORWARD -i eth1 -p icmp -m icmp --icmp-type 8 -m recent --update --seconds 1 --hitcount 1 --name PING --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p icmp -m icmp --icmp-type 8 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 20:21 -m state --state NEW -m recent --set --name FTP --mask 255.255.255.255 --rsource -m limit --limit 12/sec --limit-burst 7 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 20:21 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name FTP --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 20:21 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 23 -m state --state NEW -m recent --set --name TELNET --mask 255.255.255.255 --rsource -m limit --limit 12/sec --limit-burst 7 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 23 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name TELNET --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 23 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p udp -m udp --dport 53 -m state --state NEW -m recent --set --name DNS --mask 255.255.255.255 --rsource -m limit --limit 20/sec --limit-burst 10 -j ACCEPT
-A FORWARD -i eth1 -p udp -m udp --dport 53 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name DNS --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p udp -m udp --dport 53 -m connlimit --connlimit-above 8 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 80 -m state --state NEW -m recent --set --name HTTP --mask 255.255.255.255 --rsource -m limit --limit 20/sec --limit-burst 10 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 80 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name HTTP --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 80 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 443 -m state --state NEW -m recent --set --name HTTPS --mask 255.255.255.255 --rsource -m limit --limit 20/sec --limit-burst 10 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 443 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name HTTPS --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 443 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 6660:6667 -m state --state NEW -m recent --set --name IRC --mask 255.255.255.255 --rsource -m limit --limit 40/sec --limit-burst 20 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 6660:6667 -m state --state NEW -m recent --update --seconds 5 --hitcount 2 --name IRC --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 6660:6667 -m connlimit --connlimit-above 3 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 8080:8081 -m state --state NEW -m recent --set --name HTTP-ALT --mask 255.255.255.255 --rsource -m limit --limit 20/sec --limit-burst 10 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp --dport 8080:8081 -m state --state NEW -m recent --update --seconds 15 --hitcount 1 --name HTTP-ALT --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 8080:8081 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p udp -m udp ! --dport 53 -m state --state NEW -m recent --set --name OTHER-UDP --mask 255.255.255.255 --rsource -m limit --limit 12/min --limit-burst 10 -j LOGALLOW
-A FORWARD -i eth1 -p udp -m udp ! --dport 53 -m state --state NEW -m recent --update --seconds 60 --hitcount 1 --name OTHER-UDP --mask 255.255.255.255 --rsource -j LOGNDROP
-A FORWARD -i eth1 -p udp -m udp ! --dport 53 -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp -m state --state NEW -m recent --set --name OTHER-TCP --mask 255.255.255.255 --rsource -m limit --limit 25/min --limit-burst 10 -m multiport ! --dports 20:21,23,80,443,6660:6667,8080:8081 -j LOGALLOW
-A FORWARD -i eth1 -p tcp -m tcp -m state --state NEW -m recent --update --seconds 60 --hitcount 1 --name OTHER-TCP --mask 255.255.255.255 --rsource -m multiport ! --dports 20:21,23,80,443,6660:6667,8080:8081 -j LOGNDROP
-A FORWARD -i eth1 -p tcp -m tcp -m connlimit --connlimit-above 2 --connlimit-mask 32 --connlimit-saddr -m multiport ! --dports 20:21,23,80,443,6660:6667,8080:8081 -j LOGNDROP
-A FORWARD -i eth1 -p icmp -m icmp ! --icmp-type 8 -j LOGNDROP
-A OUTPUT -o lo -j ACCEPT
-A OUTPUT -o eth1 -j ACCEPT
-A OUTPUT -o eth0 -j ACCEPT
-A LOGALLOW -m limit --limit 500/sec -j LOG --log-prefix "BIFROZT - ALLOW "
-A LOGALLOW -j ACCEPT
-A LOGNDROP -m limit --limit 500/sec -j LOG --log-prefix "BIFROZT - BLOCK "
-A LOGNDROP -j DROP
COMMIT
# Completed on Sun Nov  1 20:02:15 2015
# Generated by iptables-save v1.4.21 on Sun Nov  1 20:02:15 2015
*mangle
:PREROUTING ACCEPT [31107:25682867]
:INPUT ACCEPT [12251:836638]
:FORWARD ACCEPT [18852:24845937]
:OUTPUT ACCEPT [11234:11520495]
:POSTROUTING ACCEPT [29967:36359292]
COMMIT
# Completed on Sun Nov  1 20:02:15 2015
# Generated by iptables-save v1.4.21 on Sun Nov  1 20:02:15 2015
*nat
:PREROUTING ACCEPT [186:13280]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [2:388]
:POSTROUTING ACCEPT [2:388]
-A PREROUTING -d 129.178.50.220/32 -i eth1 -p tcp -m tcp --dport 40960 -j DNAT --to-destination 10.10.1.79:2003
-A POSTROUTING -o eth0 -j MASQUERADE
COMMIT
# Completed on Sun Nov  1 20:02:15 2015

